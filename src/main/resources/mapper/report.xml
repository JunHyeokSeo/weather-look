<?xml version="1.0" encoding="UTF-8" ?>
 <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="report">


	<select id="reportlist" parameterType="search"
		resultType="report">

		select * from (
		select rownum rnum, re2.* from(
		select re1.*
		from
		(select daily_report.*, 'daily' as type_name, daily.title from
		daily_report
		left join daily
		on daily_report.post_id = daily.post_id
		union
		select review_report.*, 'review' as type_name, review.title from
		review_report
		left join review
		on review_report.post_id = review.post_id
		union
		select community_report.*, 'community' as type_name,
		community.title from
		community_report
		left join community
		on
		community_report.post_id = community.post_id) re1
		order by report_date
		desc) re2)
		where rnum &gt;= #{startrow} and rnum &lt;=
		#{endrow}

	</select>

	<select id="reportcount" parameterType="search" resultType="int">
		select count(*) reports from
		(select daily_report.*, 'daily' as
		type_name, daily.title from daily_report
		left join daily
		on
		daily_report.post_id = daily.post_id
		union
		select review_report.*,
		'review' as type_name, review.title from
		review_report
		left join review
		on review_report.post_id = review.post_id
		union
		select
		community_report.*, 'community' as type_name, community.title from
		community_report
		left join community
		on community_report.post_id =
		community.post_id)
		order by report_date desc
	</select>



	<delete id="removedaily" parameterType="int">
	
	delete from daily where post_id = #{post_id}
	
	</delete>
	
	<delete id="removereview" parameterType="int">
	
	delete from review where post_id = #{post_id}
	
	</delete>
	
	<delete id="removecommunity" parameterType="int">
	
	delete from community where post_id = #{post_id}
	
	</delete>
	
	
</mapper>







